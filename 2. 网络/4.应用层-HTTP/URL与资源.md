2.1浏览因特网资源

URL是浏览器寻找信息时所需的资源位置。

URI是一类更通用的资源标识符，URI由两个主要的子集URL和URN构成

URL是通过描述资源的位置来标识资源的
URN是通过名字来识别资源的，与它们当前所处位置无关。
URL分一下三部分

第一部分：URL方案。告知Web客户端怎样访问资源。
第二部分：指服务器的位置，告知Web客户端资源位于何处。
第三部分：资源路径，路径说明了请求的是服务器上那个特定的本地资源
2.2 URL的语法

URL提供了一种定位因特网上任意资源的手段，但这些资源是可以通过各种不同的方案来访问的，因此URL语法会随着方案的不同而有所不同。

大部分的URL遵循通用的URL语法，不同URL方案的风格和语法都有不少重叠
通用URL组件

组件	描述	默认值
方案	访问服务器以获取获取资源时要使用哪种协议	无
用户	某些方案访问资源时需要的用户名	匿名
密码	用户名后面可能要包含的密码，中间由冒号分隔	<E-mail地址>
主机	资源宿主服务器的主机名或点分IP地址	无
端口	资源宿主服务器正在监听的端口号。很多方案都有默认端口号(HTTP默认80)	每个方案特有
路径	服务器上资源的本地名，由一个斜杠将其前面的URL组件分隔开来。路径组件的语法是与服务器和方案有关的	无
参数	某些方案会用这个组件来指定输入参数。参数为名/值对。URL中可以包含多个参数字段，它们相互之间以及与路径的其余部分之间用分号分隔	无
查询	某些方案会用这个组件传递参数以激活应用程序。查询组件的内容没有通用格式。用字符“？”将其分隔开。	无
片段	一小片或一部分资源的名字。通过“#”将其与URL的其余部分分隔开来	无
例如 URL:http://www.joes-hardware.com:80/index.html ,其方案是http，主机为 www.joes-hardware.com,端口号80,路径/index.html
方案-使用什么协议

方案实际上是规定如何访问指定资源的主要标识符，它会告诉负责解析URL的应用程序应该使用什么协议。

方案组件必须以一个字母符号开始。由第一个“:”符号将其与URL的其余部分分隔开来。
方案名是大小写无关的。
http://www.baidu.com 和 HTTP://www.baidu.com 是一样的
主机和端口

主机组件标识了因特网上能够访问资源的宿主机器。

比如下面两个URL就指向同一个资源

http://www.joes-hardware.com:80/index.html 通过主机名

http://161.58.228.45:80/index.html 通过IP地址指向服务器的
用户名和密码

很多服务器都要求输入用户名和密码才会允许用户访问数据。

ftp://ftp.prep.ai.mit.edu/pub/gnu   //插入默认的用户名和密码
ftp://user@ftp.prep.ai.mit.edu/pub/gnu  //指定为user的用户名
ftp://user:passwd@ftp.prep.ai.mit.edu/pub/gnu  //指定了用户名和密码
http://user:passwd@www.joes-hardware.com/sales_info.txt
路径

URL的路径组件说明了资源位于服务器的什么地方。路径通常很像一个分级的文件系统路径。

可以用“/”将HTTP URL的路径组件划分成一些路径段。每个路径段都有自己的参数组件。

参数

对很多方案来说，只有简单的主机名和到达对象的路径是不够的。除了服务器正在监听的端口，以及是否能够通过用户名和密码访问资源外，很多协议都还需要更多的信息才能工作。

为了向应用程序提供它们所需的输入参数，以便正确地与服务器进行交互，URL中有一个参数组件。这个组件就是URL中的名值对列表，由“;”将其与URL的其余部分分隔开来。

比如：

ftp:prep.ai.mit.edu/pub/gnu;type=d

在这个例子中，有一个参数type=d，参数名为type，值为d
查询字符串

http://www.joes-hardware.com/inventory-check.cgi?item=123
这个URL的大部分我们见过的其他URL类似。只有问号右边的内容是新出现的。这部分被称为查询组件

URL的查询组件和标识网关资源的URL路径组件一起被发送给网关资源。基本可以将网关当做访问其他应用程序的访问点。

片段

为了引用部分资源或资源的一个片段，URL支持用片段组件来标识一个资源内部的片段。

比如：URL可以指向HTML文档中的一个特定的图片或小节。片段挂在URL的右手边，最前面有一个字符“#”

http://www.joes-hardware.com/tools.html#drills

片段drills引用了Joe的五金商店Web服务器上页面/tools.html中的一个部分，这部分名字叫做drills。
HTTP服务器通常只处理整个对象，而不是对象的片段，客户端不能讲片段传送给服务器。浏览器从服务器获得了整个资源之后，会根据片段显示你感兴趣的那部分资源。

2.3 URL快捷方式

相对URL是在某资源内部指定一个资源的便捷缩略方式。

很多浏览器还支持URL的“自动扩展”，也就是用户输入URL的一个关键部分，然后由浏览器将其余部分填充起来。

相对URL

URL有两种方式：绝对的和相对的。目前为止，我们只见过绝对URL。

绝对URL中包含有访问资源所需的全部信息。

相对URL是不完整的。要从相对URL中获取访问资源所需的全部信息，就必须相对于另一个，被称为其基础的URL进行解析。

相对URL是URL的一种便捷缩略记法。使用缩略形式的相对URL语法，就可以省略URL中的方案、主机和其他一些组件了。这些组件可以从它们所属资源的基础URL中推导出来。其他资源的URL也可以用这种缩略形式来表示。

1.基础URL

转换处理的第一步：找到基础URL。可以来自以下地方：

在资源中显式提供 有些资源会显式地指定基础URL。比如，HTML文档中可能会包含一个定义了基础URL的HTML标记<BASE>,通过它来转换那个HTML文档中的所有相对URL。
封装资源的基础URL 如果在一个没有显式指定基础URL的资源中发现了一个相对URL，可以将它所属的资源的URL作为基础。
没有基础URL 在某些情况下，没有基础URL。这通常意味着你有一个绝对URL，但有时可能只是一个不完整或损坏了的URL。
2.解析相对引用

要将相对URL转换为一个绝对URL，下一步要做的就是将相对URL和基础URL划分成组件段。

只要将基础和相对URL划分成了组件，就可以用算法来完成转换了。

自动扩展URL

有些浏览器会在用户提交URL之后，或者在用户输入的时候尝试着自动扩展URL。

这些“自动扩展”特性有以下两种方式

主机名扩展 在主机名扩展中，只要有些小提示，浏览器通常就可以在没有帮助的情况下，将你输入的主机名扩展为完整的主机名。
历史扩展 浏览器将以前用户访问过的URL历史存储起来。当你输入URL的时候，它们就可以将你输入的URL与历史记录中URL的前缀进行匹配，并提供一些完整的选项供你选择。
2.4 各种令人头疼的字符

URL字符集

有些URL中会包含任意的二进制数据。URL的设计者就将转义序列集成进去。通过转义序列，就可以用US-ASCII字符集的有限子集对任意字符值或数据进行编码了。

编码机制

为了避开安全字符集表示法带来的限制，人们设计了一种编码机制，通过一种“转义”表示法来表示不安全字符的。

这种转义表示法 包含一个百分号，后面跟着两个表示字符ASCII码的十六进制数
例：

字符	ASCII码	示例URL
~	126(0x7E)	http://www.baidu.com/~joe
字符限制

在URL中，有几个字符被保留起来，有特殊的含义。有些字符不在定义的US-ASCII可打印字符集中。还有些字符会与某些因特网网关和协议产生混淆，因此不赞成使用。

保留及受限的字符

字符	保留/受限
%	保留作为编码字符的转义标志
/	保留作为路径组件中分隔路径段的定界符
.	保留在路径组件中使用
..	保留在路径组件中使用
'#	保留作为分段定界符使用
？	保留作为查询字符串定界符使用
另外一点说明

客户端应用程序在向其他应用程序发送任意URL之前，最好把所有不安全或受限字符都进行转换。只要对所有不安全字符都进行了编码，这个URL就是可在各应用程序直接共享的规范模式

2.5 方案的世界

常见的方案格式

http
超文本传输协议，除了没有用户名和密码之外，与通用的URL格式相符。如果省略了端口，就默认为80。
基本格式：http://<host>:<post>/<path>?<query>#<frag>
https
方案https与http是一对。唯一区别在于方案https使用了网景的SSL，SSL为HTTP连接提供了端到端的加密机制。其语法与HTTP的语法相同，默认端口为443。
格式：https://<host>:<port>/<path>?<query>#<frag>
mailto
Mailto URL指向的是E-mail的行为与其他方案都有所不同(它并不指向任何可以直接访问的对象)，所以mailto URL的格式与标准URL的格式也有所不同。
格式：mailto:<RFC-822-addr-spec>
ftp
文件传输协议URL可以用来从FTP服务器上下载或向其上载文件，并获取FTP服务器上的目录结构内容的列表。在Web和URL出现之前FTP就已经存在了。Web应用程序将FTP作为一种数据访问方案使用。
格式：ftp://<user>:<password>@<host>:<port>/<path>;<params>
files
方案file表示一台指定主机(通过本地磁盘、网络文件系统或其他一些文件共享系统)上可直接访问的文件。各字段都遵循通用格式。如果省略了主机名，就默认为正在使用URL的本地主机。
格式：file://<host>/<path>
2.6 未来展望

URL可以用来命名所有现存对象，而且可以很方便地包含一些新格式。
URL还提供了一种可以在各种因特网协议间共享的统一命名机制。
URL表示的是实际的地址，而不是准确的名字。URL会告诉你资源此时处于什么位置，它会为你提供特定端口上特定服务器的名字，告诉你在何处可以找到这个资源。 - 缺点是：如果资源被移走了，URL也就不再有效了，无法再对对象进行定位。

无论对象搬到什么地方(在一个Web服务器内或是在不同的Web服务器间)，URN都能为对象提供一个稳定的名称。

永久统一资源定位符(PURL)是用URL来实现URN功能的一个例子。基本思想：在搜索资源的过程中引入另一个中间层，通过一个中介资源定位符服务器对资源的实际URL进行登记和跟踪。客户端可以向定位符请求一个永久URL，定位符可以以一个资源作为响应，将客户端重定向到资源当前实际的url上去。