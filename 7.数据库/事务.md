# 什么是事务
事务是一个操作序列，这些操作要么全执行，要么不执行。

# 事务特性

- **原子性**：指事务是一个不可分割的工作单位，事务中的操作要么全部成功，要么全部失败
- **一致性**：事务必须使数据库从一个一致性状态变换到另一个一致性状态
  - A向B转账，假设转账之前这两个用户的钱加起来总共是200，那么A向B转账之后，不管两个账户中怎么样，A用户的钱和B用户的钱加起来的总额还是200。

- **隔离性**：多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作数据所干扰，多个并发事务之间要相互隔离。
- **持久性**：一个事务一旦被提交，对数据库的改变就是永久性的

## 事务不考虑隔离性可能会引发的问题
1. **脏读**：指一个事务读取了另一个事务未提交的事务。

🌰：假设A向B转100元，对应sql语句：
```
1. update account set money = money+100 where name = "B"
1. update account set money = money-100 where name = "A"
```
当第一条sql执行完，第二条还没执行(A 没提交)，如果此时B查询自己的账户，发现自己多了100元，如果A等B走了后再回滚，B就会损失100元。

2. **不可重复读**：在一个事务内读取表的某一行数据，多次读取结果不同。

🌰：比如银行想查询A账户的余额，第一次查询账户为200元，此时A向账户内存了100元并提交了，银行又进行了一次查询，此时A账户为300元，银行两次查询的结果就不一致。

3. **虚读(幻读)**：一个事务内读取到了别的事务内插入的数据，导致前后读取不一致。

🌰：A存款100元未提交，这时银行做报表统计 account 表中所有用户的总额为 500元，然后A 提交了，这时银行再统计发现账户为600。


# 操作事务命令

## 开启事务
> start transaction

## 提交事务
> commit

## 回滚事务
> rollback

# 为什么使用事务

